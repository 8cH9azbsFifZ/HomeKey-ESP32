<h2 style="text-align: center;">Device Configuration</h2>
<form id="misc-config" action="misc-config" method="post"
  style="display: inline-flex; flex-direction: column;margin-bottom: 1rem;">
  <label for="device-name">Device Name</label>
  <input type="text" name="device-name" id="device-name" placeholder="HK" required value="%DEVICENAME%">
  <label for="control-pin">HomeSpan Control GPIO Pin</label>
  <input type="number" name="control-pin" id="control-pin" placeholder="26" required value="%CONTROLPIN%">
  <label for="led-pin">HomeSpan Status LED GPIO Pin</label>
  <input type="number" name="led-pin" id="led-pin" placeholder="2" required value="%LEDPIN%">
  <label for="nfc-s-pin">NFC Success GPIO Pin</label>
  <input type="number" name="nfc-s-pin" id="nfc-s-pin" placeholder="2" required value="%NFC1PIN%">
  <label for="nfc-s-time">NFC Success GPIO Time</label>
  <input type="number" name="nfc-s-time" id="nfc-s-time" placeholder="26" required value="%NFC1TIME%">
  <label for="nfc-s-hl">NFC Success High-Low</label>
  <input type="checkbox" name="nfc-s-hl" id="nfc-s-hl" value="1">
  <label for="nfc-f-pin">NFC Fail GPIO Pin</label>
  <input type="number" name="nfc-f-pin" id="nfc-f-pin" placeholder="2" required value="%NFC2PIN%">
  <label for="nfc-f-time">NFC Fail GPIO Time</label>
  <input type="number" name="nfc-f-time" id="nfc-f-time" placeholder="26" required value="%NFC2TIME%">
  <label for="nfc-f-hl">NFC Fail High-Low</label>
  <input type="checkbox" name="nfc-f-hl" id="nfc-f-hl" value="1">
  <button type="submit" style="margin-top: 1rem; cursor: pointer;">Submit</button>
  <button type="reset" style="cursor: pointer;">Reset</button>
</form>
<script>
  let nfcSuccessHL = "%NFC1HL%" == true;
  let nfcFailHL = "%NFC2HL%" == true;
  if(nfcSuccessHL){
    document.getElementById("nfc-s-hl").setAttribute("checked", "");
  }
  if(nfcFailHL){
    document.getElementById("nfc-f-hl").setAttribute("checked", "");
  }
  let form = document.getElementById("misc-config");
  async function handleForm(event) {
    event.preventDefault();
    let response = await fetch("misc-config", {
      body: new FormData(form),
      method: "post",
    });
    let string = await response.text();
    let element = document.querySelector("#status-text");
    if(element){
      element.remove();
    }
    let component = document.getElementById("component");
    let elStatus = document.createElement("p");
    elStatus.id = "status-text";
    elStatus.style = "color: red;";
    elStatus.innerText = string;
    document.querySelector("#component > h2").insertAdjacentElement("afterend", elStatus);
    setTimeout(() => {document.querySelector("#status-text").remove()}, 5000);
  }
  form.addEventListener('submit', handleForm);
</script>